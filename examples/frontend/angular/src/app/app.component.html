<main class="container">
  <comp-header [peers]="peers"></comp-header>
  <comp-status
    (get_state_root_hash_output)="get_state_root_hash($event)"
  ></comp-status>
  <div class="row align-items-start">
    <div class="col-sm-4 d-flex justify-content-between">
      <comp-action
        (select_action)="selectAction($event)"
        class="w-100"
      ></comp-action>
      <comp-submit-action
        (submit_action)="submitAction($event)"
      ></comp-submit-action>
    </div>
    <div class="col-sm-8 ps-0 d-flex justify-content-end">
      <comp-public-key class="input-group me-2"></comp-public-key>
      <div class="d-flex justify-content-end ms-3">
        <comp-private-key></comp-private-key>
      </div>
    </div>
  </div>
  <form
    [formGroup]="form"
    *ngIf="action && formFields && formFields.has(action)"
    class="mt-3"
  >
    <ng-container *ngFor="let row of formFields.get(action)">
      <div class="row align-items-end">
        <ng-container *ngFor="let field of row">
          <ng-container *ngIf="field.input">
            <ui-input
              #inputTemplate
              [parentForm]="form"
              [inputField]="field.input"
            ></ui-input>
            <ng-container
              *ngTemplateOutlet="
                inputTemplate.template;
                context: { parentForm: form, inputField: field.input }
              "
            ></ng-container>
          </ng-container>
          <ng-container *ngIf="field.textarea">
            <ui-textarea
              #inputTemplate
              [parentForm]="form"
              [inputField]="field.textarea"
            ></ui-textarea>
            <ng-container
              *ngTemplateOutlet="
                inputTemplate.template;
                context: { parentForm: form, inputField: field.textarea }
              "
            ></ng-container>
          </ng-container>
          <ng-container *ngIf="field.wasm_button">
            <comp-submit-wasm
              #submitTemplate
              (select_wasm)="onWasmSelected($event)"
            ></comp-submit-wasm>
            <ng-container
              *ngTemplateOutlet="submitTemplate.template"
            ></ng-container>
          </ng-container>
          <ng-container *ngIf="field.file_button">
            <comp-submit-file
              #submitTemplate
              (select_file)="onDeployFileSelected($event)"
            ></comp-submit-file>
            <ng-container
              *ngTemplateOutlet="submitTemplate.template"
            ></ng-container>
          </ng-container>
        </ng-container>
      </div>
    </ng-container>
  </form>
  <form>
    <div
      class="row mt-3 d-flex align-items-end"
      *ngIf="['get_dictionary_item'].includes(action)"
    >
      <form class="row align-items-end" (submit)="(false)">
        <div
          class="col-sm-12 mb-3"
          *ngIf="['get_dictionary_item'].includes(action)"
        >
          <div class="row">
            <div class="col-sm-5 mb-2">
              <div class="input-group">
                <label class="input-group-text" for="selectActionElt"
                  >Dictionary identifier</label
                >
                <select
                  id="selectDictIdentifierElt"
                  class="form-select form-control form-control-sm"
                  [value]="select_dict_identifier || ''"
                  (change)="
                    select_dict_identifier = selectDictIdentifierElt.value
                  "
                  #selectDictIdentifierElt
                  e2e-id="selectDictIdentifierElt"
                >
                  <option
                    value="newFromSeedUref"
                    [selected]="select_dict_identifier === 'newFromSeedUref'"
                  >
                    From Dictionary Uref
                  </option>
                  <option
                    value="newFromContractInfo"
                    [selected]="
                      select_dict_identifier === 'newFromContractInfo'
                    "
                  >
                    From Contract Info
                  </option>
                  <option
                    value="newFromAccountInfo"
                    [selected]="select_dict_identifier === 'newFromAccountInfo'"
                  >
                    From Account Info
                  </option>
                  <option
                    value="newFromDictionaryKey"
                    [selected]="
                      select_dict_identifier === 'newFromDictionaryKey'
                    "
                  >
                    From Dictionary Key
                  </option>
                </select>
              </div>
            </div>
          </div>
        </div>
        <ng-container *ngIf="['get_dictionary_item'].includes(action)">
          <div
            class="col-sm-7 mb-2"
            *ngIf="select_dict_identifier === 'newFromSeedUref'"
          >
            <label for="seedUrefElt">Dictionary Uref </label>
            <div class="form-floating">
              <input
                type="search"
                class="form-control form-control-xs"
                name="seed_uref"
                [value]="seed_uref || ''"
                placeholder="uref-0x"
                id="seedUrefElt"
                #seedUrefElt
                e2e-id="seedUrefElt"
              />
              <label for="seedUrefElt">e.g. uref-0x</label>
            </div>
          </div>
          <div
            class="col-sm-7 mb-2"
            *ngIf="select_dict_identifier === 'newFromAccountInfo'"
          >
            <label for="seedAccountHashElt">Account Hash</label>
            <div class="form-floating">
              <input
                type="search"
                class="form-control form-control-xs"
                name="seed_account_hash"
                [value]="seed_account_hash || ''"
                placeholder="account-hash-0x"
                id="seedAccountHashElt"
                #seedAccountHashElt
                e2e-id="seedAccountHashElt"
              />
              <label for="seedAccountHashElt">e.g. account-hash-0x</label>
            </div>
          </div>
          <div
            class="col-sm-7 mb-2"
            *ngIf="select_dict_identifier === 'newFromContractInfo'"
          >
            <label for="seedContractHashElt">Contract Hash</label>
            <div class="form-floating">
              <input
                type="search"
                class="form-control form-control-xs"
                name="seed_contract_hash"
                [value]="seed_contract_hash || ''"
                placeholder="hash-0x"
                id="seedContractHashElt"
                #seedContractHashElt
                e2e-id="seedContractHashElt"
              />
              <label for="seedContractHashElt">e.g. hash-0x</label>
            </div>
          </div>
          <div
            class="col-sm-7 mb-2"
            *ngIf="select_dict_identifier === 'newFromDictionaryKey'"
          >
            <label for="seedKeyElt">Dictionary Key</label>
            <div class="form-floating">
              <input
                type="search"
                class="form-control form-control-xs"
                name="seed_key"
                [value]="seed_key || ''"
                placeholder="dictionary-0x"
                id="seedKeyElt"
                #seedKeyElt
                e2e-id="seedKeyElt"
              />
              <label for="seedKeyElt">e.g. dictionary-0x</label>
            </div>
          </div>
          <div
            class="col-sm-7 mb-2"
            *ngIf="
              ['newFromContractInfo', 'newFromAccountInfo'].includes(
                select_dict_identifier
              )
            "
          >
            <label for="seedNameElt">Dictionary Name</label>
            <div class="form-floating">
              <input
                type="search"
                class="form-control form-control-xs"
                name="seed_name"
                [value]="seed_name || ''"
                placeholder="e.g. events"
                id="seedNameElt"
                #seedNameElt
                e2e-id="seedNameElt"
              />
              <label for="seedNameElt">e.g. events</label>
            </div>
          </div>
          <div
            class="col-sm-7 mb-2"
            *ngIf="select_dict_identifier !== 'newFromDictionaryKey'"
          >
            <label for="itemKeyElt">Dictionary Item key </label>
            <div class="form-floating">
              <input
                type="search"
                class="form-control form-control-xs"
                name="item_key"
                [value]="item_key || ''"
                [placeholder]="item_key"
                id="itemKeyElt"
                #itemKeyElt
                e2e-id="itemKeyElt"
              />
              <label for="itemKeyElt">e.g. Item key string</label>
            </div>
          </div>
        </ng-container>
      </form>
    </div>
    <div
      class="row d-flex mt-4 justify-content-start"
      *ngIf="['sign_deploy'].includes(action)"
    >
      <div class="col-sm-1">
        <button
          type="button"
          class="btn btn-warning"
          (click)="submitAction(action)"
          e2e-id="sign"
        >
          Sign
        </button>
      </div>
    </div>
  </form>
  <comp-error></comp-error>
  <comp-result></comp-result>
</main>
